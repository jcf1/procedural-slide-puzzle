(this["webpackJsonpblock-game"]=this["webpackJsonpblock-game"]||[]).push([[0],{17:function(e,t,s){e.exports=s(27)},27:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),h=s(13),i=s(16),r=s(1),o=s(2),l=s(5),p=s(4),c=s(3),u=function(e){var t=e.size,s=e.position,a=e.color;return{position:"absolute",width:t.width+"px",height:t.height+"px",top:s.top+"%",left:s.left+"%",backgroundColor:a,border:"1px solid #ffffff"}},d=function(e){return n.a.createElement("div",{style:u(e)})},f=function(e){Object(p.a)(s,e);var t=Object(c.a)(s);function s(){return Object(r.a)(this,s),t.apply(this,arguments)}return Object(o.a)(s,[{key:"componentDidUpdate",value:function(){var e,t,s,a=this.props.size_percent,n=this.props.position,h=this.props.goal,i=this.props.blocks;switch(this.props.direction){case"UP":if(e=0,n.top<=e)this.props.playerDeath();else if(n.left===h.left&&n.top===h.top+a.height)this.props.win();else for(s=0;s<i.length;s++)t=i[s],n.left===t.left&&n.top===t.top+a.height&&this.props.playerStop();break;case"LEFT":if(e=0,n.left<=e)this.props.playerDeath();else if(n.top===h.top&&n.left===h.left+a.width)this.props.win();else for(s=0;s<i.length;s++)t=i[s],n.top===t.top&&n.left===t.left+a.width&&this.props.playerStop();break;case"RIGHT":if(e=100,n.left+a.width>=e)this.props.playerDeath();else if(n.top===h.top&&n.left+a.width===h.left)this.props.win();else for(s=0;s<i.length;s++)t=i[s],n.top===t.top&&n.left+a.width===t.left&&this.props.playerStop();break;case"DOWN":if(e=100,n.top+a.height>=e)this.props.playerDeath();else if(n.left===h.left&&n.top+a.height===h.top)this.props.win();else for(s=0;s<i.length;s++)t=i[s],n.left===t.left&&n.top+a.height===t.top&&this.props.playerStop();break;default:return}}},{key:"render",value:function(){var e=this.props.size,t=this.props.position.top,s=this.props.position.left;return n.a.createElement(d,{size:e,position:{top:t,left:s},color:"blue"})}}]),s}(a.Component),b=function(e){Object(p.a)(s,e);var t=Object(c.a)(s);function s(){return Object(r.a)(this,s),t.apply(this,arguments)}return Object(o.a)(s,[{key:"render",value:function(){var e=this.props.size,t=this.props.position.top,s=this.props.position.left;return n.a.createElement(d,{size:e,position:{top:t,left:s},color:"red"})}}]),s}(a.Component),w=function(e){Object(p.a)(s,e);var t=Object(c.a)(s);function s(){return Object(r.a)(this,s),t.apply(this,arguments)}return Object(o.a)(s,[{key:"render",value:function(){var e=this.props.size,t=this.props.position.top,s=this.props.position.left;return n.a.createElement(d,{size:e,position:{top:t,left:s},color:"#000000"})}}]),s}(a.Component),y=function(e){Object(p.a)(s,e);var t=Object(c.a)(s);function s(e){var a;return Object(r.a)(this,s),(a=t.call(this,e)).style=function(){return{position:"relative",margin:"1% auto",width:a.props.boardSize+"px",height:a.props.boardSize+"px",border:a.props.boardSize/100+"px solid #000000"}},a.updatePlayerPos=function(){var e=a.state.playerPos;switch(a.state.playerDir){case"LEFT":e={top:e.top,left:e.left-1};break;case"UP":e={top:e.top-1,left:e.left};break;case"RIGHT":e={top:e.top,left:e.left+1};break;case"DOWN":e={top:e.top+1,left:e.left};break;default:return}a.setState({playerPos:e})},a.positionCalc=function(e){var t=100/a.props.width;return{top:100/a.props.height*e.y,left:t*e.x}},a.state={blockSize:{width:0,height:0,border:0},blockSize_percent:{width:0,height:0},playerPos:{top:0,left:0},playerDir:"LOCK",goalPos:{top:0,left:0},blocks:[]},a.handleKeyPress=a.handleKeyPress.bind(Object(l.a)(a)),a.playerDeath=a.playerDeath.bind(Object(l.a)(a)),a.playerStop=a.playerStop.bind(Object(l.a)(a)),a}return Object(o.a)(s,[{key:"handleKeyPress",value:function(e){if("NONE"===this.state.playerDir){var t;switch(e.keyCode){case 37:t="LEFT";break;case 38:t="UP";break;case 39:t="RIGHT";break;case 40:t="DOWN";break;default:return}this.setState({playerDir:t})}}},{key:"playerDeath",value:function(){this.setState({playerPos:this.positionCalc(this.props.start),playerDir:"NONE"})}},{key:"playerStop",value:function(){this.setState({playerDir:"NONE"})}},{key:"win",value:function(){this.playerDeath()}},{key:"update",value:function(){var e=this,t=100/this.props.width/100*this.props.boardSize-2,s=100/this.props.height/100*this.props.boardSize-2,a=100/this.props.width,n=100/this.props.height;this.setState({playerPos:this.positionCalc(this.props.start),goalPos:this.positionCalc(this.props.goal),blocks:this.props.blocks.map((function(t,s){return e.positionCalc(t)})),playerDir:"NONE",blockSize:{width:t,height:s,border:1},blockSize_percent:{width:a,height:n}})}},{key:"componentDidMount",value:function(){this.setState({playerPos:this.props.start}),window.onkeydown=this.handleKeyPress,this.playerInterval=setInterval(this.updatePlayerPos,15)}},{key:"componentDidUpdate",value:function(e){this.props.seed===e.seed&&this.props.blocks.length===e.blocks.length||this.update()}},{key:"render",value:function(){var e=this;return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement("center",null,n.a.createElement("h2",null,"Current Seed: ",this.props.current))),n.a.createElement("div",{style:this.style()},n.a.createElement(f,{size:this.state.blockSize,size_percent:this.state.blockSize_percent,position:this.state.playerPos,direction:this.state.playerDir,blocks:this.state.blocks,goal:this.state.goalPos,win:this.win,playerDeath:this.playerDeath,playerStop:this.playerStop}),n.a.createElement(b,{size:this.state.blockSize,position:this.state.goalPos}),this.state.blocks.map((function(t,s){return n.a.createElement(w,{key:s,size:e.state.blockSize,position:t})}))))}}]),s}(a.Component),k=s(10);function g(e,t){this.y=e,this.x=t,this.hash=e+","+t}Math.seededRandom=function(e){Math.seed=(9301*Math.seed+49297)%233280;var t=Math.seed/233280;return Math.round(t*e)};var v,m,x,S,z,E,M,O;function P(e){switch(e){case 2:return 3;case 3:return 2;case 1:return 0;case 0:return 1;default:return-1}}function D(e,t,s,a,n,h){var i,r,o,l,p,c,u=[],d=[],f=[],b=n.y,w=n.x;switch(h){case 0:for(i=b-1;i>0&&3!==e[i][w];i--)d.push(new g(i,w));for(i=b+1;i<t-1&&3!==e[i][w];i++)f.push(new g(i,w));var y;for(i=0;i<a;i++){y=S[i];var k=[];for(r=0;r<d.length;r++)l=new g((o=d[r]).y-1,o.x),(E.includes(o.hash)||y.has(l.hash)||m[a-1].has(o.hash))&&k.push(r);var v=[];for(r=0;r<f.length;r++)l=new g((o=f[r]).y-1,o.x),(E.includes(o.hash)||y.has(l.hash)||m[a-1].has(o.hash))&&v.push(r);for(r=0;r<k.length;r++)d.splice(k[r],1);for(r=0;r<v.length;r++)f.splice(v[r],1)}break;case 1:for(i=w-1;i>0&&3!==e[b][i];i--)d.push(new g(b,i));for(i=w+1;i<s-1&&3!==e[b][i];i++)f.push(new g(b,i));for(i=0;i<a;i++){y=S[i];var x=[];for(r=0;r<d.length;r++)l=new g((o=d[r]).y,o.x-1),(E.includes(o.hash)||y.has(l.hash)||m[a-1].has(o.hash))&&x.push(r);var z=[];for(r=0;r<f.length;r++)l=new g((o=f[r]).y,o.x+1),(E.includes(o.hash)||y.has(l.hash)||m[a-1].has(o.hash))&&z.push(r);for(r=0;r<x.length;r++)d.splice(x[r],1);for(r=0;r<z.length;r++)f.splice(z[r],1)}}for(i=0;i<d.length;i++)c=d[p=i+Math.seededRandom(d.length-i-1)],d.splice(p,1,d[i]),d.splice(i,1,c);for(i=0;i<f.length;i++)c=f[p=i+Math.seededRandom(f.length-i-1)],f.splice(p,1,f[i]),f.splice(i,1,c);return u.push(d),u.push(f),u}function j(e,t,s,a,n,h,i){var r,o,l,p,c=[],u=[],d=[],f=h.y,b=h.x;switch(i){case 0:for(r=f-1;r>0&&3!==e[r][b];r--)o=new g(r,b),m[n].get(o.hash)===a&&u.push(o);for(r=f+1;r<t-1&&3!==e[r][b];r++)o=new g(r,b),m[n].get(o.hash)===a&&d.push(o);break;case 1:for(r=b-1;r>0&&3!==e[f][r];r--)o=new g(f,r),m[n].get(o.hash)===a&&u.push(o);for(r=b+1;r<s-1&&3!==e[f][r];r++)o=new g(f,r),m[n].get(o.hash)===a&&d.push(o)}for(r=0;r<u.length;r++)p=u[l=r+Math.seededRandom(u.length-r-1)],u.splice(l,1,u[r]),u.splice(r,1,p);for(r=0;r<d.length;r++)p=d[l=r+Math.seededRandom(d.length-r-1)],d.splice(l,1,d[r]),d.splice(r,1,p);return c.push(u),c.push(d),c}function C(e,t,s,a,n,h,i,r){var o=a,l=n;-1===r&&(o.set(i.hash,0),l.set(i.hash,i.hash));var p=[],c=[],u=[];switch(r){case 2:case 3:u.push(0),u.push(1);break;case 1:case 0:u.push(2),u.push(3);break;default:u.push(0),u.push(1),u.push(2),u.push(3)}for(;u.length>0;)p.push(i),c.push(u.pop());for(;p.length>0&&c.length>0;){var d,f,b=p.shift(),w=c.shift(),y=o.get(b.hash)+1,k=!0,v=b.y,S=b.x;switch(w){case 2:for(d=S-1;d>=0;d--){if(f=new g(v,d+1),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash),k=!1),0===d&&0===e[v][d]||2===e[v][d]){f=new g(v,d),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash));break}if(3===e[v][d]){k||(p.push(f),c.push(1),p.push(f),c.push(0));break}}break;case 3:for(d=S+1;d<s;d++){if(f=new g(v,d-1),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash),k=!1),d===s-1&&0===e[v][d]||2===e[v][d]){f=new g(v,d),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash));break}if(3===e[v][d]){k||(p.push(f),c.push(1),p.push(f),c.push(0));break}}break;case 1:for(d=v-1;d>=0;d--){if(f=new g(d+1,S),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash),k=!1),0===d&&0===e[d][S]||2===e[d][S]){f=new g(d,S),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash));break}if(3===e[d][S]){k||(p.push(f),c.push(2),p.push(f),c.push(3));break}}break;case 0:for(d=v+1;d<t;d++){if(f=new g(d-1,S),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash),k=!1),d===t-1&&0===e[d][S]||2===e[d][S]){f=new g(d,S),o.has(f.hash)||(o.set(f.hash,y),l.set(f.hash,b.hash));break}if(3===e[d][S]){k||(p.push(f),c.push(2),p.push(f),c.push(3));break}}}}m.splice(h,1,o),x.splice(h,1,l)}function R(e,t,s,a){var n,h,i=s.y,r=s.x,o=new Map;switch(a){case 2:for(n=t.x;n>=r;n--)h=new g(i,n),o.set(h.hash,h);break;case 3:for(n=t.x;n<=r;n++)h=new g(i,n),o.set(h.hash,h);break;case 1:for(n=t.y;n>=i;n--)h=new g(n,r),o.set(h.hash,h);break;case 0:for(n=t.y;n<=i;n++)h=new g(n,r),o.set(h.hash,h)}S.splice(e,1,o)}function N(e,t,s,a){var n,h=s.y,i=s.x;switch(a){case 2:e[h][i-1]=3,n=new g(h,i-1);break;case 3:e[h][i+1]=3,n=new g(h,i+1);break;case 1:e[h-1][i]=3,n=new g(h-1,i);break;case 0:e[h+1][i]=3,n=new g(h+1,i);break;default:n=new g(-1,-1)}return S[t].set(n.hash,n),M.splice(t,1,n),m[t-1].has(n.hash)}function I(e,t){var s=M[t],a=s.y,n=s.x;e[a][n]=0}function W(e,t,s,a){var n=0===Math.seededRandom(1)?0:1;return T(e,t,s,a,n)||T(e,t,s,a,n=0===n?1:0)?z[a]:null}function T(e,t,s,a,n){var h=0,i=0,r=function(e,t,s,a,n){var h=z[a];C(e,t,s,new Map,new Map,a,h,-1);var i=D(e,t,s,a,h,n);if(O[a]=i,0===i[0].length&&0===i[1].length)return!1;return!0}(e,t,s,h,n);if(!r)return!1;for(;h<a-1;){if(h===a-2){if(r=U(e,t,s,h,a,n))return!0}else r=B(e,t,s,h,n);if(n=0===n?1:0,r?h+=1:(I(e,h),h-=1),h>i&&(i=h),-1===h||h<=i-2){for(;h>-1;)I(e,h),h--;return!1}}return!1}function B(e,t,s,a,n){var h,i=z[a],r=O[a];if(r[0].length>0&&r[1].length>0)h=0===Math.seededRandom(1)?0===n?1:2:0===n?0:3;else if(r[0].length>0)h=0===n?1:2;else{if(!(r[1].length>0))return!1;h=0===n?0:3}n=0===n?1:0;var o,l=2===h||1===h?0:1,p=r[l];do{if(0===p.length&&(h=P(h),l=1===l?0:1,0===(p=O[a][l]).length))return!1;r=D(e,t,s,a+1,o=p.shift(),n)}while(0===r[0].length&&0===r[1].length);v.splice(a,1,h),R(a+1,i,o,h);var c=N(e,a+1,o,h);if(O.splice(a+1,1,r),z.splice(a+1,1,o),E.splice(a+1,1,o.hash),c){var u=z[0];C(e,t,s,new Map,new Map,a+1,u,-1)}else C(e,t,s,m[a],x[a],a+1,o,h);return!0}function U(e,t,s,a,n,h){var i,r=z[a],o=O[a];if(o[0].length>0&&o[1].length>0)i=0===Math.seededRandom(1)?0===h?1:2:0===h?0:3;else if(o[0].length>0)i=0===h?1:2;else{if(!(o[1].length>0))return!1;i=0===h?0:3}h=0===h?1:0;var l,p,c=2===i||1===i?0:1,u=o[c],d=z[0];do{if(0===u.length&&(i=P(i),c=1===c?0:1,0===(u=O[a][c]).length))return!1;switch(l=u.shift(),i){case 2:p=new g(l.y,l.x-1);break;case 3:p=new g(l.y,l.x+1);break;case 1:p=new g(l.y-1,l.x);break;case 0:p=new g(l.y+1,l.x);break;default:p=new g(l.y,l.x)}S[a].has(p.hash)||(e[p.y][p.x]=3,C(e,t,s,new Map,new Map,a+1,d,-1),0===(o=j(e,t,s,n,a+1,l,h))[0].length&&0===o[1].length&&(e[p.y][p.x]=0))}while(0===o[0].length&&0===o[1].length);if(v.splice(a,1,i),R(a+1,r,l,i),N(e,a+1,l,i),z.splice(a+1,1,l),E.splice(a+1,1,l.hash),r=l,o[0].length>0&&o[1].length>0)0===Math.seededRandom(1)?(i=0===h?1:2,u=o[0]):(i=0===h?0:3,u=o[1]);else if(o[0].length>0)i=0===h?1:2,u=o[0];else{if(!(o[1].length>0))return!1;i=0===h?0:3,u=o[1]}return R(a+2,r,l=u.shift(),i),z.splice(a+2,1,l),E.splice(a+2,1,l.hash),v.splice(a+1,1,i),e[l.y][l.x]=2,!0}function L(e,t,s,a,n){var h,i,r=a.y,o=a.x;switch(n){case 2:for(h=s.x;h>=o;h--)0===e[r][h]&&(i=new g(r,h),t.set(i.hash,i));break;case 3:for(h=s.x;h<=o;h++)0===e[r][h]&&(i=new g(r,h),t.set(i.hash,i));break;case 1:for(h=s.y;h>=r;h--)0===e[h][o]&&(i=new g(h,o),t.set(i.hash,i));break;case 0:for(h=s.y;h<=r;h++)0===e[h][o]&&(i=new g(h,o),t.set(i.hash,i))}return t}function F(e,t){if(e.x===t.x){if(e.y<t.y)return 0;if(e.y>t.y)return 1}else if(e.y===t.y){if(e.x<t.x)return 3;if(e.x>t.x)return 2}return-1}var K={makePuzzle:function(e,t,s,a){var n;Math.seed=e,n=s>=a?3*a/4+Math.seededRandom(a/2):3*s/4+Math.seededRandom(s/2);for(var h=[],i=0;i<a;i++){h[i]=[];for(var r=0;r<s;r++)h[i].push(0)}for(var o=[],l=0;l<a;l++)for(var p=0;p<s;p++)o.push(new g(l,p));var c,u=new g(0,0);do{for(v=[],S=[],z=[],E=[],M=[],m=[],x=[],O=[],i=0;i<n;i++)v.push(-1),S.push(new Map),z.push(new g(-1,-1)),E.push("-1,-1"),M.push(new g(-1,-1)),m.push(new Map),x.push(new Map),O.push([]);h[(u=o.splice(Math.seededRandom(o.length-1),1)[0]).y][u.x]=1,S[0].set(u.hash,u),z.splice(0,1,u),E.splice(0,1,u.hash),M.splice(0,1,u),c=W(h,a,s,n)}while(null==c&&o.length>0);if(null==c)return null;if(M.splice(0,1),t){var d=function(e,t,s,a,n,h,i){var r=[];C(e,t,s,new Map,new Map,0,a,-1);for(var o=m[0],l=x[0],p=0;p<i;p++){for(var c=o,u=l,d=new Map,f=0;f<S.length;f++){var b,w=S[f],y=Object(k.a)(w.keys());try{for(y.s();!(b=y.n()).done;){var v=b.value;d.set(v,w[v])}}catch(K){y.e(K)}finally{y.f()}}var z,E=new Map,M=[],O=Object(k.a)(u.keys());try{for(O.s();!(z=O.n()).done;){var P=z.value;if(!d.has(P)){var D=P.split(","),j=new g(Number(D[0]),Number(D[1]));E.set(P,j),M.push(j)}}}catch(K){O.e(K)}finally{O.f()}for(var R=!1;0!==M.length&&!R;){var N=M.splice(Math.seededRandom(M.length-1),1)[0],I=u.get(N.hash).split(","),W=F(new g(Number(I[0]),Number(I[1])),N),T=void 0,B=N.y,U=N.x;switch(W){case 2:if(U-1<0)continue;T=new g(B,U-1);break;case 3:if(U+1>=s)continue;T=new g(B,U+1);break;case 1:if(B-1<0)continue;T=new g(B-1,U);break;case 0:if(U+1<t)continue;T=new g(B+1,U)}d.has(T)||0!==e[T.y][T.x]||0!==e[N.y][N.x]||(e[T.y][T.x]=3,C(e,t,s,new Map,new Map,0,a,-1),c=m[0],u=x[0],c.get(n.hash)===h?(R=!0,r.push(T),d=L(e,d,N,l.get(N.hash),W),o=c,l=u):(e[T.y][T.x]=0,c=o,u=l))}if(0===M.length)return r}return r}(h,a,s,u,c,n,Math.floor(n/2)+Math.seededRandom(Math.floor(n/4)));M=M.concat(d)}return{start:u,goal:c,blocks:M}}},_=function(){return Math.floor(1e9*Math.random())},H=function(e){Object(p.a)(s,e);var t=Object(c.a)(s);function s(e){var a;return Object(r.a)(this,s),(a=t.call(this,e)).makeNewPuzzle=function(e){a.setState({current:e});var t=K.makePuzzle(e,a.state.fake,a.state.width,a.state.height);a.setState({start:t.start,goal:t.goal,blocks:t.blocks})},a.buttonClicked=function(){var e=document.getElementById("seed-box").value;(e<0||e>1e9)&&(e=_(),document.getElementById("seed-box").value=e),a.setState({seed:e}),a.makeNewPuzzle(e)},a.newSeed=function(){var e=_();a.setState({seed:e}),document.getElementById("seed-box").value=e},a.reset=function(){var e=_();a.setState({seed:e}),document.getElementById("seed-box").value=e,a.makeNewPuzzle(e)},a.state={windowSize:{width:0,height:0},start:{y:0,x:0},goal:{y:0,x:0},blocks:[],seed:-1,current:-1,width:20,height:20,fake:!1},a.buttonClicked=a.buttonClicked.bind(Object(l.a)(a)),a.updateWindowDimensions=a.updateWindowDimensions.bind(Object(l.a)(a)),a}return Object(o.a)(s,[{key:"componentDidMount",value:function(){this.buttonClicked(),this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions.bind(this))}},{key:"updateWindowDimensions",value:function(){this.setState({windowSize:{width:window.innerWidth,height:window.innerHeight}})}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"game-options"},n.a.createElement("div",null,n.a.createElement("label",null,"Random Seed:"),n.a.createElement("input",{type:"number",min:"0",id:"seed-box",defaultValue:_()})),n.a.createElement("div",null,n.a.createElement("label",null,"Add Fake Blocks:"),n.a.createElement("input",{id:"fake-box",type:"checkbox",onChange:function(t){return e.setState((function(e){return{fake:!e.fake}}))}})),n.a.createElement("div",null,n.a.createElement("button",{onClick:this.buttonClicked.bind(this)},"Make Puzzle")),n.a.createElement("div",null,n.a.createElement("button",{onClick:this.newSeed.bind(this)},"Random Seed")),n.a.createElement("div",null,n.a.createElement(y,{seed:this.state.seed,boardSize:.6*(this.state.windowSize.width>this.state.windowSize.height?this.state.windowSize.height:this.state.windowSize.width),current:this.state.current,width:this.state.width,height:this.state.height,start:this.state.start,goal:this.state.goal,blocks:this.state.blocks,reset:this.reset.bind(this)})),n.a.createElement("div",{style:{margin:"0 auto",width:.75*this.state.windowSize.width+"px"}},n.a.createElement("div",null,n.a.createElement("b",null,"OBJECTIVE:"),"\u2003Use the arrow keys to move the blue block to the red block by sliding and colliding with the black blocks. If you slide off the board, you will be put back into the starting position."),n.a.createElement("div",null,n.a.createElement("b",null,"OPTIONS:"),'\u2003\u2003 Change the level by changing the "Random Seed" value above and clickint the "Make Puzzle" button. The "Random Seed" button will generate a new "Random Seed" for you. Setting the "Fake Blocks" option will add blocks that are not required for the level\'s solution to the board.')))}}]),s}(a.Component),G=document.getElementById("root");Object(h.render)(n.a.createElement("div",null,n.a.createElement(i.a,{basename:"/procedural-slide-puzzle"},n.a.createElement("div",null,n.a.createElement("header",null,n.a.createElement("h1",null,"Procedural Slide Puzzles"))),n.a.createElement(H,null))),G)}},[[17,1,2]]]);
//# sourceMappingURL=main.10dd725d.chunk.js.map